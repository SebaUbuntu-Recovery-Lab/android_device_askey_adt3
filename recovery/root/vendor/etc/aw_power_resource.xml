<?xml version="1.0" encoding="utf-8"?>
<!--
/*
 * Copyright (C) 2022 The Android Open Source Project
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
 -->

<awpowerhal>
    <resource name="cpu_governor" type="sysfs" default="schedutil">
        <config name="powersave" priority="1">
            <write path="/sys/devices/system/cpu/cpufreq/policy0/scaling_governor" value="powersave"/>
            <write path="/sys/devices/system/cpu/cpufreq/policy4/scaling_governor" value="powersave"/>
        </config>
        <config name="performance"  priority="2">
            <write path="/sys/devices/system/cpu/cpufreq/policy0/scaling_governor" value="performance"/>
            <write path="/sys/devices/system/cpu/cpufreq/policy4/scaling_governor" value="performance"/>
        </config>
        <config name="schedutil"  priority="3">
            <write path="/sys/devices/system/cpu/cpufreq/policy0/scaling_governor" value="schedutil"/>
            <write path="/sys/devices/system/cpu/cpufreq/policy4/scaling_governor" value="schedutil"/>
            <write path="/sys/devices/system/cpu/cpufreq/schedutil/rate_limit_us" value="20000" />
        </config>
    </resource>
    <resource name="dfs_governor" type="sysfs" default="sunxi_actmon">
        <config name="performance"  priority="1">
            <write path="/sys/class/devfreq/3120000.dmcfreq/governor" value="performance"/>
        </config>
        <config name="sunxi_actmon"  priority="2">
            <write path="/sys/class/devfreq/3120000.dmcfreq/governor" value="sunxi_actmon"/>
        </config>
    </resource>
    <resource name="tp_idle" type="sysfs" default="wake">
        <config name="wake"  priority="1">
            <write path="/sys/class/ctp/tp_idle" value="0"/>
        </config>
        <config name="idle"  priority="2">
            <write path="/sys/class/ctp/tp_idle" value="1"/>
        </config>
    </resource>
    <resource name="io_schedule" type="sysfs" default="mq_deadline_low_latency">
        <config name="io_boot"  priority="1">
            <write path="/sys/block/mmcblk0/queue/scheduler" value="mq-deadline"/>
            <write path="/sys/block/mmcblk0/queue/iosched/read_expire" value="500"/>
            <write path="/sys/block/mmcblk0/queue/iosched/write_expire" value="5000"/>
            <write path="/sys/block/mmcblk0/queue/iosched/writes_starved" value="2"/>
            <write path="/sys/block/mmcblk0/queue/iosched/fifo_batch" value="16"/>
        </config>
        <config name="mq_deadline_high_batch"  priority="2">
            <write path="/sys/block/mmcblk0/queue/scheduler" value="mq-deadline"/>
            <write path="/sys/block/mmcblk0/queue/iosched/read_expire" value="750"/>
            <write path="/sys/block/mmcblk0/queue/iosched/writes_starved" value="1"/>
            <write path="/sys/block/mmcblk0/queue/iosched/fifo_batch" value="64"/>
        </config>
        <config name="mq_deadline_read_priority_latency"  priority="3">
            <write path="/sys/block/mmcblk0/queue/scheduler" value="mq-deadline"/>
            <write path="/sys/block/mmcblk0/queue/iosched/read_expire" value="250"/>
            <write path="/sys/block/mmcblk0/queue/iosched/writes_starved" value="4"/>
            <write path="/sys/block/mmcblk0/queue/iosched/fifo_batch" value="32"/>
        </config>
        <config name="mq_deadline_low_latency"  priority="4">
            <write path="/sys/block/mmcblk0/queue/scheduler" value="mq-deadline"/>
            <write path="/sys/block/mmcblk0/queue/iosched/read_expire" value="100"/>
            <write path="/sys/block/mmcblk0/queue/iosched/write_expire" value="1000"/>
            <write path="/sys/block/mmcblk0/queue/iosched/writes_starved" value="2"/>
            <write path="/sys/block/mmcblk0/queue/iosched/fifo_batch" value="12"/>
        </config>
    </resource>
    <resource name="thermal_control" type="sysfs" default="enabled">
        <config name="disabled"  priority="1">
            <write path="/sys/class/thermal/thermal_zone0/mode" value="disabled"/>
            <write path="/sys/class/thermal/thermal_zone0/cdev0/cur_state" value="0"/>
            <write path="/sys/class/thermal/thermal_zone1/mode" value="disabled"/>
            <write path="/sys/class/thermal/thermal_zone1/cdev0/cur_state" value="0"/>
        </config>
        <config name="enabled"  priority="2">
            <write path="/sys/class/thermal/thermal_zone0/mode" value="enabled"/>
            <write path="/sys/class/thermal/thermal_zone1/mode" value="enabled"/>
        </config>
    </resource>
    <resource name="uclamp_limit" type="syscall" default="unlimit">
        <config name="unlimit"  priority="1">
            <write proc="rcu_preempt" thread="rcu_preempt" min="1024" max="1024"/>
            <write proc="/system/bin/lmkd" thread="lmkd" min="1024" max="1024"/>
            <write proc="/vendor/bin/hw/android.hardware.graphics.composer-service.sunxi" thread="CommitThread" min="1024" max="1024"/>
        </config>
        <config name="limit"  priority="2">
            <write proc="rcu_preempt" thread="rcu_preempt" min="0" max="1024"/>
            <write proc="/system/bin/lmkd" thread="lmkd" min="0" max="1024"/>
            <write proc="/vendor/bin/hw/android.hardware.graphics.composer-service.sunxi" thread="CommitThread" min="0" max="1024"/>
        </config>
    </resource>
</awpowerhal>
